实践出真知、成功必自律

代理：当一个对象不能直接使用，可以在客户端和目标对象直接创建一个中介，这个中介就是代理

动态代理：基于反射原理

掌握的程度：

1、什么是动态代理？

​	使用JDK的反射机制，创建对象的能力，创建的是代理类的对象，而不用你创建类文件，不用写java文件

​	动态：在程序执行时，调用JDK提供的方法才能创建代理类的对象

2、知道动态代理能做什么？

可以在不改变原代码的基础上（也改不了），可以在代码上增加自己的功能代码



使用代理模式的作用：

1、功能增强：在你原有的功能上，增加额外的功能。新增加的功能，叫做功能增强

2、控制访问：代理类·不让你访问目标，例如：商家不允许你访问厂家



实现代理的方式:

静态代理：代理类是自己手工实现的，自己创建一个java类，表示代理类，同时你所代理的目标是确定的

​		特点：实现比较简单、容易理解

​		缺点：当目标类增加了，代理类也可能成倍的增加，当接口改变时，影响的代理类和目标类都需要发生改变

动态代理：

​			在静态代理的目标类很多的时候，可以使用动态代理，避免静态代理的缺点

​			动态代理的目标类即使很多，  代理类的数量可以很少，当修改了接口中的方法时，不会影响代理类

在程序执行的过程中，使用JDK的反射机制，创建代理类对象，并动态的指定代理目标类

动态代理就是一种创建java对象的能力，让你不用再创建TaoBao对象，就能创建代理类对象



代理类中完成的功能：

1、目标类的中方法的调用

2、功能增强



动态代理的分类：

动态代理的两种实现方式：

1、使用JDK（理解）动态代理：要求目标类必须有接口，没接口不行

​		反射包 java.lang.reflect 包下的，里面有三个类：InvocationHandler、Method、Proxy

2、通过CGLIB（了解）实现动态代理：可以实现无接口的类的动态代理 

​		是一个第三方的工具库，可以创建代理对象，原理是继承，通过继承目标类，创建它的子类，在子类

​		中重写与父类重名的方法，实现功能的修改							





实现动态代理的步骤：

1、创建接口，定义目标类需要完成的功能

2、创建目标类实现接口

3、创建InvocationHandler接口的实现类，在invoke方法中完成代理类的功能，重写invoke方法，在第二个参数，method上调用method.invoke()，传调用的接口  在invoke方法中增强功能

​		1、调用目标方法

​		2、增强功能

4、使用proxy类的静态方法，创建代理对象，并把返回值转为接口类型，强转一下，然后调用方法

​		使用这个类的静态方法创建对象，newProxyInstance()创建对象

​		三个参数，分别是

​		1、ClassLoader loader 类加载器，负责向内存中加载对象的，通过反射机制获得 先getClass，在get类加载

​		2、接口，目标对象实现的接口，也是反射获取的                 Interfacerent.getClass().getInterface();

​		3、InvocationHandler h  这个是自己写的，代理类要完成的功能       实现invocationHander的实现类

第一个和第三个参数都是实现InvocationHandler的参数，只有第二个传的是接口，

